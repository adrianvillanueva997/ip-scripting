use std::net::Ipv4Addr;

use ipnet::Ipv4Net;

fn main() {
    let subnets = vec![
        "172.16.0.0/24",
        "172.16.1.0/24",
        "172.16.2.0/24",
        "172.16.3.0/24",
    ];
    let used_subnets: Vec<Ipv4Net> = subnets.into_iter().map(|x| x.parse().unwrap()).collect();
    let databricks_subnets: Vec<&str> = vec![
        "172.16.0.0/26",
        "172.16.0.128/26",
        "172.16.0.192/26",
        "172.16.0.64/26",
        "172.16.1.0/26",
        "172.16.1.128/26",
        "172.16.1.192/26",
        "172.16.1.64/26",
        "172.16.10.0/26",
        "172.16.10.128/26",
        "172.16.10.192/26",
        "172.16.10.64/26",
        "172.16.11.0/26",
        "172.16.11.128/26",
        "172.16.11.192/26",
        "172.16.11.64/26",
        "172.16.12.0/26",
        "172.16.12.128/26",
        "172.16.12.192/26",
        "172.16.12.64/26",
        "172.16.13.0/26",
        "172.16.13.128/26",
        "172.16.13.192/26",
        "172.16.13.64/26",
        "172.16.14.0/26",
        "172.16.14.128/26",
        "172.16.14.192/26",
        "172.16.14.64/26",
        "172.16.15.0/26",
        "172.16.15.128/26",
        "172.16.15.192/26",
        "172.16.15.64/26",
        "172.16.16.0/26",
        "172.16.16.128/26",
        "172.16.16.192/26",
        "172.16.16.64/26",
        "172.16.17.0/26",
        "172.16.17.128/26",
        "172.16.17.192/26",
        "172.16.17.64/26",
        "172.16.18.0/26",
        "172.16.18.128/26",
        "172.16.18.192/26",
        "172.16.18.64/26",
        "172.16.19.0/26",
        "172.16.19.128/26",
        "172.16.19.192/26",
        "172.16.19.64/26",
        "172.16.2.0/26",
        "172.16.2.128/26",
        "172.16.2.192/26",
        "172.16.2.64/26",
        "172.16.20.0/26",
        "172.16.20.128/26",
        "172.16.20.192/26",
        "172.16.20.64/26",
        "172.16.21.0/26",
        "172.16.21.128/26",
        "172.16.21.192/26",
        "172.16.21.64/26",
        "172.16.22.0/26",
        "172.16.22.128/26",
        "172.16.22.192/26",
        "172.16.22.64/26",
        "172.16.23.0/26",
        "172.16.23.128/26",
        "172.16.23.192/26",
        "172.16.23.64/26",
        "172.16.24.0/26",
        "172.16.24.128/26",
        "172.16.24.192/26",
        "172.16.24.64/26",
        "172.16.25.0/26",
        "172.16.25.128/26",
        "172.16.25.192/26",
        "172.16.25.64/26",
        "172.16.26.0/26",
        "172.16.26.128/26",
        "172.16.26.192/26",
        "172.16.26.64/26",
        "172.16.27.0/26",
        "172.16.27.128/26",
        "172.16.27.192/26",
        "172.16.27.64/26",
        "172.16.28.0/26",
        "172.16.28.128/26",
        "172.16.28.192/26",
        "172.16.28.64/26",
        "172.16.29.0/26",
        "172.16.29.128/26",
        "172.16.29.192/26",
        "172.16.29.64/26",
        "172.16.3.0/26",
        "172.16.3.128/26",
        "172.16.3.192/26",
        "172.16.3.64/26",
        "172.16.30.0/26",
        "172.16.30.128/26",
        "172.16.30.192/26",
        "172.16.30.64/26",
        "172.16.31.0/26",
        "172.16.31.128/26",
        "172.16.31.192/26",
        "172.16.31.64/26",
        "172.16.32.0/26",
        "172.16.32.128/26",
        "172.16.32.192/26",
        "172.16.32.64/26",
        "172.16.33.0/26",
        "172.16.33.128/26",
        "172.16.33.192/26",
        "172.16.33.64/26",
        "172.16.34.0/26",
        "172.16.34.128/26",
        "172.16.34.192/26",
        "172.16.34.64/26",
        "172.16.35.0/26",
        "172.16.35.128/26",
        "172.16.35.192/26",
        "172.16.35.64/26",
        "172.16.36.0/26",
        "172.16.36.128/26",
        "172.16.36.192/26",
        "172.16.36.64/26",
        "172.16.37.0/26",
        "172.16.37.128/26",
        "172.16.37.192/26",
        "172.16.37.64/26",
        "172.16.38.0/26",
        "172.16.38.128/26",
        "172.16.38.192/26",
        "172.16.38.64/26",
        "172.16.39.0/26",
        "172.16.39.128/26",
        "172.16.39.192/26",
        "172.16.39.64/26",
        "172.16.4.0/26",
        "172.16.4.128/26",
        "172.16.4.192/26",
        "172.16.4.64/26",
        "172.16.40.0/26",
        "172.16.40.128/26",
        "172.16.40.192/26",
        "172.16.40.64/26",
        "172.16.41.0/26",
        "172.16.41.128/26",
        "172.16.41.192/26",
        "172.16.41.64/26",
        "172.16.42.0/26",
        "172.16.42.128/26",
        "172.16.42.192/26",
        "172.16.42.64/26",
        "172.16.43.0/26",
        "172.16.43.128/26",
        "172.16.43.192/26",
        "172.16.43.64/26",
        "172.16.44.0/26",
        "172.16.44.128/26",
        "172.16.44.192/26",
        "172.16.44.64/26",
        "172.16.45.0/26",
        "172.16.45.128/26",
        "172.16.45.192/26",
        "172.16.45.64/26",
        "172.16.46.0/26",
        "172.16.46.128/26",
        "172.16.46.192/26",
        "172.16.46.64/26",
        "172.16.47.0/26",
        "172.16.47.128/26",
        "172.16.47.192/26",
        "172.16.47.64/26",
        "172.16.48.0/26",
        "172.16.48.128/26",
        "172.16.48.192/26",
        "172.16.48.64/26",
        "172.16.49.0/26",
        "172.16.49.128/26",
        "172.16.49.192/26",
        "172.16.49.64/26",
        "172.16.5.0/26",
        "172.16.5.128/26",
        "172.16.5.192/26",
        "172.16.5.64/26",
        "172.16.50.0/26",
        "172.16.50.128/26",
        "172.16.50.192/26",
        "172.16.50.64/26",
        "172.16.51.0/26",
        "172.16.51.128/26",
        "172.16.51.192/26",
        "172.16.51.64/26",
        "172.16.52.0/26",
        "172.16.52.128/26",
        "172.16.52.192/26",
        "172.16.52.64/26",
        "172.16.53.0/26",
        "172.16.53.128/26",
        "172.16.53.192/26",
        "172.16.53.64/26",
        "172.16.54.0/26",
        "172.16.54.128/26",
        "172.16.54.192/26",
        "172.16.54.64/26",
        "172.16.55.0/26",
        "172.16.55.128/26",
        "172.16.55.192/26",
        "172.16.55.64/26",
        "172.16.56.0/26",
        "172.16.56.128/26",
        "172.16.56.192/26",
        "172.16.56.64/26",
        "172.16.57.0/26",
        "172.16.57.128/26",
        "172.16.57.192/26",
        "172.16.57.64/26",
        "172.16.58.0/26",
        "172.16.58.128/26",
        "172.16.58.192/26",
        "172.16.58.64/26",
        "172.16.59.0/26",
        "172.16.59.128/26",
        "172.16.59.192/26",
        "172.16.59.64/26",
        "172.16.6.0/26",
        "172.16.6.128/26",
        "172.16.6.192/26",
        "172.16.6.64/26",
        "172.16.60.0/26",
        "172.16.60.128/26",
        "172.16.60.192/26",
        "172.16.60.64/26",
        "172.16.61.0/26",
        "172.16.61.128/26",
        "172.16.61.192/26",
        "172.16.61.64/26",
        "172.16.62.0/26",
        "172.16.62.128/26",
        "172.16.62.192/26",
        "172.16.62.64/26",
        "172.16.63.0/26",
        "172.16.63.128/26",
        "172.16.63.192/26",
        "172.16.63.64/26",
        "172.16.7.0/26",
        "172.16.7.128/26",
        "172.16.7.192/26",
        "172.16.7.64/26",
        "172.16.8.0/26",
        "172.16.8.128/26",
        "172.16.8.192/26",
        "172.16.8.64/26",
        "172.16.9.0/26",
        "172.16.9.128/26",
        "172.16.9.192/26",
        "172.16.9.64/26",
    ];
    let databricks_subnets: Vec<Ipv4Net> = databricks_subnets
        .iter()
        .map(|x| x.parse().unwrap())
        .collect();
    let mut available_subnets: Vec<Ipv4Addr> = Vec::new();
    for subnet in databricks_subnets {
        let available_hosts = subnet.hosts().filter(|_| !used_subnets.contains(&subnet));
        available_subnets.extend(available_hosts);
    }
    println!("Subnet: {:?} ", available_subnets);
}
